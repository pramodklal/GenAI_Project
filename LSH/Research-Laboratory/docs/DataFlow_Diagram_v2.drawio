<mxfile host="app.diagrams.net" version="24.7.17">
  <diagram name="Research Laboratory Data Flow 2025" id="dataflow-v2">
    <mxGraphModel dx="2400" dy="1400" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1400">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>
        
        <!-- Title -->
        <mxCell id="title" value="Research Laboratory - Complete Data Flow (Updated Dec 2025)" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=22;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="200" y="20" width="1200" height="40" as="geometry"/>
        </mxCell>
        
        <mxCell id="subtitle" value="User â†’ Streamlit UI â†’ AI Agents (GPT-4o) â†’ Validators â†’ AstraDBHelper â†’ Astra DB (10 Collections) | MCP API Access" style="text;html=1;strokeColor=none;fillColor=none;align=center;fontSize=13;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="200" y="60" width="1200" height="25" as="geometry"/>
        </mxCell>
        
        <!-- FLOW 1: User Entry -->
        <mxCell id="flow1-box" value="1ï¸âƒ£ USER ACCESS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1D5E7;strokeColor=#9673A6;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="100" y="120" width="320" height="100" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow1-text" value="ðŸ‘¤ Research Scientist&#xa;ðŸ”¬ Lab Manager&#xa;ðŸ“Š Data Analyst&#xa;&#xa;Access: http://localhost:8501&#xa;Command: streamlit run ui/app.py" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="120" y="150" width="280" height="60" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#9673A6;" edge="1" parent="1" source="flow1-box" target="flow2-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow1-label" value="Navigate Pages" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;fontSize=9;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="240" y="240" width="100" height="20" as="geometry"/>
        </mxCell>
        
        <!-- FLOW 2: UI Pages -->
        <mxCell id="flow2-box" value="2ï¸âƒ£ STREAMLIT UI (ui/ folder)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="100" y="280" width="320" height="140" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow2-text" value="ðŸ“± ui/app.py - Main Dashboard&#xa;&#xa;Pages (ui/pages/):&#xa;â€¢ 1_Research_Projects.py&#xa;â€¢ 2_Clinical_Trials.py&#xa;â€¢ 3_Drug_Discovery.py&#xa;â€¢ 4_Lab_Experiments.py&#xa;â€¢ 5_CSV_Import.py (3 tabs)&#xa;&#xa;Actions: Form Entry | CSV Upload | View Data" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="120" y="310" width="280" height="100" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#6C8EBF;" edge="1" parent="1" source="flow2-box" target="flow3-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow2-label" value="Data Entry/Upload" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;fontSize=9;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="215" y="440" width="110" height="20" as="geometry"/>
        </mxCell>
        
        <!-- FLOW 3: Validation -->
        <mxCell id="flow3-box" value="3ï¸âƒ£ DATA VALIDATION (src/utils/)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#BAC8D3;strokeColor=#23445D;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="100" y="480" width="320" height="120" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow3-text" value="ðŸ“‹ validators.py Functions:&#xa;&#xa;âœ… validate_compound_formula()&#xa;âœ… validate_trial_id()&#xa;âœ… validate_project_data()&#xa;âœ… validate_experiment_data()&#xa;âœ… sanitize_input()&#xa;âœ… validate_date_range()&#xa;&#xa;Ensures: Required fields, formats, ranges" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="120" y="510" width="280" height="80" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#23445D;" edge="1" parent="1" source="flow3-box" target="flow4-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow3-label" value="Valid Data" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;fontSize=9;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="235" y="620" width="70" height="20" as="geometry"/>
        </mxCell>
        
        <!-- FLOW 4: AI Agents -->
        <mxCell id="flow4-box" value="4ï¸âƒ£ AI AGENTS - OpenAI GPT-4o (src/agents/)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6CC;strokeColor=#D79B00;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="100" y="660" width="320" height="180" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow4-text" value="ðŸ¤– 6 Specialized AI Agents:&#xa;&#xa;1. clinical_trial_agent.py&#xa;   â†’ Trial analysis, compliance&#xa;2. drug_discovery_agent.py&#xa;   â†’ Candidate evaluation, molecular search&#xa;3. lab_experiment_agent.py&#xa;   â†’ Result analysis, protocol suggestions&#xa;4. research_publication_agent.py&#xa;   â†’ Paper search, summarization&#xa;5. patent_analysis_agent.py&#xa;   â†’ Patent landscape, prior art&#xa;6. research_analytics_agent.py&#xa;   â†’ Dashboard metrics, reports&#xa;&#xa;Each agent: OpenAI API â†’ GPT-4o responses" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="120" y="690" width="280" height="140" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow4" value="" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#D79B00;" edge="1" parent="1" source="flow4-box" target="flow5-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow4-label" value="DB Operations" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;fontSize=9;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="225" y="860" width="90" height="20" as="geometry"/>
        </mxCell>
        
        <!-- FLOW 5: Database Helper -->
        <mxCell id="flow5-box" value="5ï¸âƒ£ DATABASE HELPER (src/database/)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="100" y="900" width="320" height="140" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow5-text" value="ðŸ—„ï¸ astra_helper.py (AstraDBHelper)&#xa;&#xa;Operations:&#xa;â€¢ insert_document() - Add records&#xa;â€¢ query_documents() - Retrieve data&#xa;â€¢ update_document() - Modify records&#xa;â€¢ delete_document() - Remove records&#xa;â€¢ vector_search() - Similarity search&#xa;â€¢ create_collection() - Setup&#xa;â€¢ get_collection_stats() - Metrics&#xa;&#xa;Connection: astrapy 2.1.0 â†’ Data API" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="120" y="930" width="280" height="100" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow5" value="" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#82B366;" edge="1" parent="1" source="flow5-box" target="flow6-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="arrow5-label" value="Store/Retrieve" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;fontSize=9;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="225" y="1060" width="90" height="20" as="geometry"/>
        </mxCell>
        
        <!-- FLOW 6: Astra DB -->
        <mxCell id="flow6-box" value="6ï¸âƒ£ ASTRA DB - 10 COLLECTIONS" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#666666;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="100" y="1100" width="320" height="220" as="geometry"/>
        </mxCell>
        
        <mxCell id="flow6-text" value="â˜ï¸ DataStax Astra DB Serverless&#xa;&#xa;ðŸ“ Regular Collections (7):&#xa;1. research_projects&#xa;2. clinical_trials&#xa;3. drug_candidates&#xa;4. lab_experiments&#xa;5. research_compounds&#xa;6. trial_participants&#xa;7. research_publications&#xa;&#xa;ðŸ” Vector Collections (3) - 1536D:&#xa;8. molecular_structures ($vector)&#xa;9. research_papers ($vector)&#xa;10. patent_documents ($vector)&#xa;&#xa;Storage: JSON documents with metadata" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="120" y="1130" width="280" height="180" as="geometry"/>
        </mxCell>
        
        <!-- PARALLEL FLOW: Vector Embeddings -->
        <mxCell id="vector-flow-box" value="ðŸ”€ VECTOR EMBEDDING FLOW" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="500" y="660" width="320" height="200" as="geometry"/>
        </mxCell>
        
        <mxCell id="vector-flow-text" value="For Vector Collections Only:&#xa;&#xa;STEP A: Text Input&#xa;Example: &quot;Aspirin molecular structure&quot;&#xa;&#xa;STEP B: OpenAI Embedding API&#xa;â†’ text-embedding-3-small model&#xa;â†’ Generate 1536-dimensional vector&#xa;â†’ [0.123, -0.456, 0.789, ...]&#xa;&#xa;STEP C: Store with $vector field&#xa;Document: {&#xa;  _id: &quot;mol_001&quot;,&#xa;  name: &quot;Aspirin&quot;,&#xa;  $vector: [1536 floats]&#xa;}&#xa;&#xa;STEP D: Vector Search&#xa;Query vector â†’ Find similar items&#xa;Cosine similarity â†’ Top K results" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="520" y="690" width="280" height="160" as="geometry"/>
        </mxCell>
        
        <mxCell id="vector-arrow" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#D6B656;dashed=1;" edge="1" parent="1" source="flow4-box" target="vector-flow-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="vector-arrow2" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#D6B656;dashed=1;" edge="1" parent="1" source="vector-flow-box" target="flow6-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <!-- MCP SERVER FLOW -->
        <mxCell id="mcp-flow-box" value="ðŸ”Œ MCP SERVER ACCESS (Parallel)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="900" y="400" width="320" height="240" as="geometry"/>
        </mxCell>
        
        <mxCell id="mcp-flow-text" value="ðŸ”Œ mcp_server.py (Root MCP)&#xa;&#xa;18 MCP Tools Available:&#xa;&#xa;Query (5):&#xa;â€¢ query_research_projects&#xa;â€¢ query_clinical_trials&#xa;â€¢ query_drug_candidates&#xa;â€¢ query_lab_experiments&#xa;â€¢ query_trial_participants&#xa;&#xa;Insert (3):&#xa;â€¢ insert_research_project&#xa;â€¢ insert_clinical_trial&#xa;â€¢ insert_drug_candidate&#xa;&#xa;Vector Search (3):&#xa;â€¢ search_molecular_structures&#xa;â€¢ search_research_papers&#xa;â€¢ search_patents&#xa;&#xa;Analytics (3) + Bulk (4)&#xa;&#xa;Access: Claude Desktop, MCP clients" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="920" y="430" width="280" height="200" as="geometry"/>
        </mxCell>
        
        <mxCell id="mcp-arrow" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#B85450;dashed=1;" edge="1" parent="1" source="mcp-flow-box" target="flow5-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <mxCell id="mcp-label" value="Programmatic API Access" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;fontSize=9;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="680" y="750" width="140" height="20" as="geometry"/>
        </mxCell>
        
        <!-- CSV IMPORT FLOW -->
        <mxCell id="csv-flow-box" value="ðŸ“¤ CSV IMPORT FLOW (Special)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;verticalAlign=top;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="900" y="700" width="320" height="220" as="geometry"/>
        </mxCell>
        
        <mxCell id="csv-flow-text" value="ðŸ“‚ ui/pages/5_CSV_Import.py&#xa;&#xa;TAB 1: Upload CSV&#xa;â€¢ File upload (drag/drop)&#xa;â€¢ Preview first 10 rows&#xa;â€¢ Column analysis (types, nulls)&#xa;â€¢ Settings: batch size, skip errors&#xa;â€¢ Import with progress bar&#xa;&#xa;TAB 2: Manage Collections&#xa;â€¢ List all collections + metrics&#xa;â€¢ Create new collections&#xa;â€¢ Delete collections&#xa;â€¢ View collection details&#xa;&#xa;TAB 3: Import History&#xa;â€¢ Session import tracking&#xa;â€¢ Success/failure rates&#xa;â€¢ Error logs&#xa;â€¢ Download results&#xa;&#xa;Flow: CSV â†’ Pandas â†’ Validation â†’&#xa;      Batch Insert â†’ Progress Update" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="920" y="730" width="280" height="180" as="geometry"/>
        </mxCell>
        
        <mxCell id="csv-arrow" value="" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#6C8EBF;dashed=1;" edge="1" parent="1" source="csv-flow-box" target="flow5-box">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        
        <!-- RESPONSE FLOW (Return) -->
        <mxCell id="return-arrow" value="" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#999999;dashed=1;startArrow=classic;startFill=1;" edge="1" parent="1" source="flow6-box" target="flow2-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="50" y="1210"/>
              <mxPoint x="50" y="350"/>
            </Array>
          </mxGeometry>
        </mxCell>
        
        <mxCell id="return-label" value="RESPONSE FLOW&#xa;Data â†’ UI Display" style="text;html=1;strokeColor=none;fillColor=#FFFFFF;align=center;fontSize=9;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="-30" y="650" width="100" height="40" as="geometry"/>
        </mxCell>
        
        <!-- SUMMARY BOX -->
        <mxCell id="summary-box" value="ðŸ“Š DATA FLOW SUMMARY" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1D5E7;strokeColor=#9673A6;verticalAlign=top;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="500" y="1000" width="720" height="320" as="geometry"/>
        </mxCell>
        
        <mxCell id="summary-text" value="ðŸ”„ Primary Flow (Manual Entry):&#xa;User â†’ UI Form â†’ Validators â†’ AI Agent â†’ AstraDBHelper â†’ Astra DB â†’ Display Results&#xa;&#xa;ðŸ”„ CSV Import Flow:&#xa;User â†’ CSV Upload â†’ Preview â†’ Validation â†’ Batch Insert â†’ Progress Bar â†’ Success/Error Report&#xa;&#xa;ðŸ”„ Vector Search Flow:&#xa;User Query â†’ OpenAI Embedding API (1536D) â†’ Vector Search â†’ Similar Items â†’ Ranked Results&#xa;&#xa;ðŸ”„ MCP API Flow (External):&#xa;MCP Client â†’ MCP Server Tools â†’ AstraDBHelper â†’ Astra DB â†’ JSON Response&#xa;&#xa;ðŸ”„ AI Agent Flow:&#xa;User Question â†’ AI Agent â†’ OpenAI GPT-4o â†’ Context + DB Query â†’ Generated Response&#xa;&#xa;ðŸ“ˆ Key Features:&#xa;âœ… Real-time validation (before DB insert)&#xa;âœ… Batch processing (CSV imports up to 1000 rows)&#xa;âœ… Vector similarity search (molecular structures, papers, patents)&#xa;âœ… AI-powered analytics (6 specialized agents)&#xa;âœ… MCP programmatic access (18 tools)&#xa;âœ… Error handling and logging (try-except everywhere)&#xa;âœ… Progress tracking (st.progress bars)&#xa;&#xa;ðŸ›¡ï¸ Data Quality:&#xa;â€¢ Input sanitization (SQL injection prevention)&#xa;â€¢ Format validation (dates, IDs, formulas)&#xa;â€¢ Required field checks&#xa;â€¢ Type coercion (str, int, float, date)&#xa;â€¢ Range validation (budgets, phases)&#xa;&#xa;âš¡ Performance:&#xa;â€¢ Batch inserts (configurable size)&#xa;â€¢ Connection pooling (Astra DB)&#xa;â€¢ Async operations (MCP server)&#xa;â€¢ Caching (st.cache_data)&#xa;â€¢ Pagination (large result sets)" style="text;html=1;strokeColor=none;fillColor=none;align=left;fontSize=8;" vertex="1" parent="1">
          <mxGeometry x="520" y="1030" width="680" height="280" as="geometry"/>
        </mxCell>
        
        <!-- Footer -->
        <mxCell id="footer" value="âœ… Updated: December 2025 | ðŸŽ¯ Professional Structure | ðŸ“‚ Folder: ui/, src/agents/, src/mcp_servers/, src/database/, src/utils/" style="text;html=1;strokeColor=none;fillColor=#F5F5F5;align=center;fontSize=10;fontStyle=2;" vertex="1" parent="1">
          <mxGeometry x="100" y="1340" width="1120" height="30" as="geometry"/>
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
